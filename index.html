<!DOCTYPE html>
<html lang="vi" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bio-Karma: Gi·∫£i M√£ C∆° Ch·∫ø Sinh H·ªçc Nh√¢n Qu·∫£</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">

    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        tech: ['Orbitron', 'sans-serif'],
                    },
                    colors: {
                        'bio-bg': '#F0F4F8',       /* Light Blue-Grey Background */
                        'bio-panel': '#FFFFFF',    /* White Panels */
                        'text-main': '#1e293b',    /* Dark Slate Text */
                        'text-muted': '#64748b',   /* Muted Text */
                        'tech-blue': '#2563eb',    /* Stronger Blue for light mode */
                    },
                    boxShadow: {
                        'soft': '0 4px 20px rgba(0, 0, 0, 0.05)', /* Soft shadow */
                        'glow-bad': '0 0 10px rgba(239, 68, 68, 0.3)',
                        'glow-good': '0 0 10px rgba(16, 185, 129, 0.3)',
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #F0F4F8; color: #1e293b; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #F0F4F8; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }

        /* Scanning Line Animation - Adjusted for Light Mode */
        .scan-line {
            position: absolute;
            width: 100%;
            height: 2px;
            background: rgba(37, 99, 235, 0.3);
            animation: scan 3s linear infinite;
        }

        @keyframes scan {
            0% { top: 0%; opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { top: 100%; opacity: 0; }
        }

        /* Heartbeat Animation */
        .heartbeat { animation: beat 1s infinite; }
        @keyframes beat {
            0% { transform: scale(1); }
            15% { transform: scale(1.1); }
            30% { transform: scale(1); }
            45% { transform: scale(1.1); }
            60% { transform: scale(1); }
        }
        .heartbeat-stress { animation: beat 0.4s infinite; } 

        /* Toggle Switch */
        .toggle-checkbox:checked {
            right: 0;
            border-color: #10b981;
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: #10b981;
        }
        
        .chart-wrapper {
            position: relative;
            height: 250px;
            width: 100%;
        }
    </style>
</head>
<body>

    <!-- Header -->
    <header class="border-b border-slate-200 bg-white/80 backdrop-blur-md sticky top-0 z-50 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <i class="fa-solid fa-dna text-tech-blue text-2xl"></i>
                <div>
                    <h1 class="font-tech text-xl text-slate-800 tracking-wider">PROJECT BIO-KARMA</h1>
                    <p class="text-xs text-slate-500">Gi·∫£i M√£ C∆° Ch·∫ø Sinh H·ªçc C·ªßa Thi·ªán & √Åc</p>
                </div>
            </div>
            <div class="hidden md:block text-xs text-slate-500 font-mono bg-slate-100 px-3 py-1 rounded-full">
                SYSTEM STATUS: <span class="text-green-600 font-bold animate-pulse">ONLINE</span>
            </div>
        </div>
    </header>

    <!-- Main Controller Section -->
    <section class="py-10 px-4">
        <div class="max-w-7xl mx-auto">
            
            <!-- Control Panel -->
            <div class="bg-bio-panel border border-slate-200 rounded-3xl p-8 mb-10 shadow-soft relative overflow-hidden">
                <!-- Decorative top gradient -->
                <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-blue-400 to-transparent opacity-30"></div>
                
                <div class="text-center mb-10">
                    <h2 class="text-2xl font-bold text-slate-800 mb-2">M√î PH·ªéNG TR·∫†NG TH√ÅI C∆† TH·ªÇ</h2>
                    <p class="text-slate-500 mb-8">G·∫°t c·∫ßn ƒë·ªÉ xem ph·∫£n ·ª©ng sinh h·ªçc thay ƒë·ªïi nh∆∞ th·∫ø n√†o</p>
                    
                    <!-- The Big Switch -->
                    <div class="flex items-center justify-center gap-6 bg-slate-50 inline-flex px-8 py-4 rounded-full border border-slate-200 shadow-inner">
                        <span class="text-red-500 font-bold text-lg transition-all duration-300 opacity-50" id="label-bad">NH√ÇN √ÅC (Stress)</span>
                        
                        <div class="relative inline-block w-20 h-10 align-middle select-none transition duration-200 ease-in">
                            <input type="checkbox" name="toggle" id="karma-toggle" class="toggle-checkbox absolute block w-8 h-8 rounded-full bg-white border-4 appearance-none cursor-pointer top-1 left-1 transition-all duration-300 z-10 shadow-md"/>
                            <label for="karma-toggle" class="toggle-label block overflow-hidden h-10 rounded-full bg-slate-300 cursor-pointer transition-colors duration-300"></label>
                        </div>
                        
                        <span class="text-slate-400 font-bold text-lg transition-all duration-300 opacity-50" id="label-good">NH√ÇN L√ÄNH (Heal)</span>
                    </div>
                </div>

                <!-- Dashboard Grid -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    
                    <!-- Panel 1: Brain Chemistry (√ù) -->
                    <div class="bg-white rounded-2xl p-6 border border-slate-100 shadow-soft relative group hover:shadow-lg transition-shadow">
                        <h3 class="font-tech text-tech-blue text-sm mb-4 border-b border-slate-100 pb-2 font-bold">
                            <i class="fa-solid fa-brain mr-2"></i> N√ÉO B·ªò & H√ìA CH·∫§T (√ù)
                        </h3>
                        <div class="chart-wrapper">
                            <canvas id="brainChart"></canvas>
                        </div>
                        <div class="mt-4 text-sm text-slate-600 bg-slate-50 p-3 rounded-lg" id="brain-text">
                            <!-- Dynamic Content -->
                        </div>
                    </div>

                    <!-- Panel 2: Vagus Nerve & Heart (Kh·∫©u) -->
                    <div class="bg-white rounded-2xl p-6 border border-slate-100 shadow-soft relative hover:shadow-lg transition-shadow">
                        <h3 class="font-tech text-tech-blue text-sm mb-4 border-b border-slate-100 pb-2 font-bold">
                            <i class="fa-solid fa-heart-pulse mr-2"></i> TIM M·∫†CH & L·ªúI N√ìI (KH·∫®U)
                        </h3>
                        <div class="flex flex-col items-center justify-center h-[200px]">
                            <div class="relative">
                                <div class="absolute inset-0 bg-red-100 rounded-full scale-150 opacity-20 animate-pulse"></div>
                                <i class="fa-solid fa-heart text-6xl mb-4 transition-all duration-300 relative z-10" id="heart-icon"></i>
                            </div>
                            <div class="text-4xl font-mono font-bold tracking-tighter" id="hr-display">-- BPM</div>
                            <div class="text-xs text-slate-400 mt-2 font-semibold">BI·∫æN THI√äN NH·ªäP TIM (HRV)</div>
                        </div>
                        <div class="mt-4 text-sm text-slate-600 bg-slate-50 p-3 rounded-lg" id="heart-text">
                            <!-- Dynamic Content -->
                        </div>
                    </div>

                    <!-- Panel 3: Epigenetics (Th√¢n) -->
                    <div class="bg-white rounded-2xl p-6 border border-slate-100 shadow-soft relative hover:shadow-lg transition-shadow">
                        <h3 class="font-tech text-tech-blue text-sm mb-4 border-b border-slate-100 pb-2 font-bold">
                            <i class="fa-solid fa-dna mr-2"></i> T·∫æ B√ÄO & BI·ªÇU SINH (TH√ÇN)
                        </h3>
                        <div class="flex justify-center items-center h-[200px] relative">
                            <!-- DNA Animation Placeholder -->
                            <div class="w-full h-6 bg-slate-200 rounded-full overflow-hidden relative shadow-inner">
                                <div id="immune-bar" class="h-full bg-slate-500 w-1/2 transition-all duration-1000 relative overflow-hidden">
                                    <div class="absolute inset-0 bg-white/20 w-full h-full animate-[scan_2s_linear_infinite]"></div>
                                </div>
                            </div>
                            <div class="absolute inset-0 flex flex-col justify-center items-center">
                                <span class="text-2xl font-bold drop-shadow-md" id="immune-status" style="text-shadow: 0 1px 2px rgba(0,0,0,0.1);">Trung T√≠nh</span>
                                <span class="text-xs text-slate-500 mt-1 font-semibold bg-white/80 px-2 py-0.5 rounded-full backdrop-blur-sm">H·ªÜ MI·ªÑN D·ªäCH (NK Cells)</span>
                            </div>
                        </div>
                        <div class="mt-4 text-sm text-slate-600 bg-slate-50 p-3 rounded-lg" id="body-text">
                            <!-- Dynamic Content -->
                        </div>
                    </div>

                </div>
            </div>

            <!-- Deep Dive Analysis Sections -->
            <div class="space-y-16">
                
                <!-- Section 1: √ù (Mind) -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-10 items-center">
                    <div class="space-y-4">
                        <span class="text-tech-blue font-bold text-xs tracking-widest uppercase">Ph√¢n T√≠ch Chuy√™n S√¢u #01</span>
                        <h2 class="text-3xl font-bold text-slate-800">C∆° Ch·∫ø C·ªßa "√ù": [Image of Amygdala in brain] <br>Nh√† M√°y H√≥a Ch·∫•t</h2>
                        <div class="p-5 bg-white rounded-xl border-l-4 border-red-500 shadow-sm">
                            <h4 class="font-bold text-red-600">Khi Gieo Nh√¢n √Åc (Tham/S√¢n)</h4>
                            <p class="text-slate-600 text-sm mt-2 leading-relaxed">H·∫°ch h·∫°nh nh√¢n k√≠ch ho·∫°t ch·∫ø ƒë·ªô "Chi·∫øn ƒë·∫•u". Tuy·∫øn th∆∞·ª£ng th·∫≠n b∆°m <strong>Cortisol</strong>. C∆° th·ªÉ t·ª± ƒë·∫ßu ƒë·ªôc ch√≠nh m√¨nh b·∫±ng stress m√£n t√≠nh.</p>
                        </div>
                        <div class="p-5 bg-white rounded-xl border-l-4 border-green-500 shadow-sm">
                            <h4 class="font-bold text-green-600">Khi Gieo Nh√¢n L√†nh (T·ª´ Bi)</h4>
                            <p class="text-slate-600 text-sm mt-2 leading-relaxed">V·ªè n√£o tr∆∞·ªõc tr√°n [Image of Prefrontal Cortex activity] k√≠ch ho·∫°t. N√£o ti·∫øt <strong>Oxytocin & Serotonin</strong>. C∆° th·ªÉ ƒëi v√†o tr·∫°ng th√°i ch·ªØa l√†nh v√† t√°i t·∫°o.</p>
                        </div>
                    </div>
                    <div class="bg-white p-2 rounded-2xl border border-slate-200 shadow-soft h-80 relative overflow-hidden">
                         <div class="absolute inset-0 flex items-center justify-center bg-slate-50">
                            <!-- Placeholder visual -->
                            <div class="text-center opacity-20">
                                <i class="fa-solid fa-brain text-9xl text-slate-800"></i>
                            </div>
                            <div class="absolute inset-0 scan-line"></div>
                        </div>
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="text-center bg-white/90 p-6 rounded-2xl shadow-lg backdrop-blur-sm border border-slate-100">
                                <div class="text-4xl mb-2">üß†</div>
                                <div class="font-tech text-tech-blue font-bold">HO·∫†T ƒê·ªòNG TH·∫¶N KINH</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section 2: Kh·∫©u (Speech) -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-10 items-center">
                    <div class="order-2 md:order-1 bg-white p-6 rounded-2xl border border-slate-200 shadow-soft h-80 flex items-center justify-center relative">
                        <div class="absolute top-4 left-4 text-xs font-mono text-slate-400 font-bold">VAGUS NERVE STIMULATION</div>
                         <!-- Abstract Waveform Visualization -->
                        <div class="flex items-end gap-1.5 h-40 w-full justify-center px-10" id="voice-waves">
                            <!-- JS will generate bars here -->
                        </div>
                    </div>
                    <div class="order-1 md:order-2 space-y-4">
                        <span class="text-tech-blue font-bold text-xs tracking-widest uppercase">Ph√¢n T√≠ch Chuy√™n S√¢u #02</span>
                        <h2 class="text-3xl font-bold text-slate-800">C∆° Ch·∫ø C·ªßa "Kh·∫©u": [Image of Vagus Nerve anatomy] <br>S√≥ng Rung ƒê·ªông</h2>
                        <p class="text-slate-600">L·ªùi n√≥i t√°c ƒë·ªông tr·ª±c ti·∫øp l√™n <strong>D√¢y th·∫ßn kinh ph·∫ø v·ªã</strong> - c·∫ßu n·ªëi gi·ªØa n√£o v√† c√°c c∆° quan n·ªôi t·∫°ng.</p>
                        <ul class="space-y-4 mt-4">
                            <li class="flex items-start gap-4 bg-white p-4 rounded-lg shadow-sm border border-slate-100">
                                <div class="bg-red-100 p-2 rounded-full"><i class="fa-solid fa-bolt text-red-500"></i></div>
                                <div>
                                    <strong class="text-slate-800 block mb-1">N√≥i d·ªëi (Cognitive Load)</strong>
                                    <span class="text-slate-500 text-sm">N√£o ph·∫£i l√†m vi·ªác g·∫•p ƒë√¥i ƒë·ªÉ duy tr√¨ k·ªãch b·∫£n gi·∫£. G√¢y cƒÉng th·∫≥ng th·∫ßn kinh v√† m·∫•t ng·ªß.</span>
                                </div>
                            </li>
                            <li class="flex items-start gap-4 bg-white p-4 rounded-lg shadow-sm border border-slate-100">
                                <div class="bg-green-100 p-2 rounded-full"><i class="fa-solid fa-music text-green-500"></i></div>
                                <div>
                                    <strong class="text-slate-800 block mb-1">√Åi ng·ªØ (Resonance)</strong>
                                    <span class="text-slate-500 text-sm">√Çm ƒëi·ªáu tr·∫ßm ·∫•m k√≠ch ho·∫°t h·ªá th·∫ßn kinh ƒë·ªëi giao c·∫£m, gi√∫p tim ƒë·∫≠p ch·∫≠m v√† ti√™u h√≥a t·ªët.</span>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- Section 3: Th√¢n (Action) -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-10 items-center">
                    <div class="space-y-4">
                        <span class="text-tech-blue font-bold text-xs tracking-widest uppercase">Ph√¢n T√≠ch Chuy√™n S√¢u #03</span>
                        <h2 class="text-3xl font-bold text-slate-800">C∆° Ch·∫ø C·ªßa "Th√¢n": <br>T·∫ø B√†o G∆∞∆°ng & Bi·ªÉu Sinh</h2>
                        <div class="grid grid-cols-1 gap-4">
                            <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition">
                                <h4 class="font-tech text-tech-blue font-bold mb-2 text-sm uppercase">Mirror Neurons (T·∫ø B√†o G∆∞∆°ng)</h4>
                                <p class="text-sm text-slate-600">Khi b·∫°n l√†m ƒëau ng∆∞·ªùi kh√°c, n√£o b·ªô c·ªßa b·∫°n c≈©ng m√¥ ph·ªèng l·∫°i n·ªói ƒëau ƒë√≥. V·ªÅ m·∫∑t th·∫ßn kinh h·ªçc, <strong>l√†m √°c l√† t·ª± l√†m ƒëau ch√≠nh m√¨nh</strong>.</p>
                            </div>
                            <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition">
                                <h4 class="font-tech text-tech-blue font-bold mb-2 text-sm uppercase">Epigenetics (Bi·ªÉu Sinh Di Truy·ªÅn)</h4>
                                <p class="text-sm text-slate-600">L·ªëi s·ªëng t·ª´ bi c√≥ th·ªÉ "b·∫≠t" c√°c gen b·∫£o v·ªá c∆° th·ªÉ (kh√°ng vi√™m, ch·ªëng ung th∆∞) v√† "t·∫Øt" c√°c gen g√¢y b·ªánh.</p>
                            </div>
                        </div>
                    </div>
                     <div class="bg-white p-6 rounded-2xl border border-slate-200 shadow-soft h-80 flex flex-col items-center justify-center relative overflow-hidden group">
                        <div class="absolute inset-0 bg-slate-50 opacity-50 group-hover:opacity-30 transition"></div>
                        <i class="fa-solid fa-dna text-7xl text-slate-300 mb-6 group-hover:scale-110 transition-transform duration-500"></i>
                        <div class="text-center relative z-10">
                            <h3 class="text-slate-800 font-bold text-lg">DNA METHYLATION</h3>
                            <p class="text-xs text-slate-500 mt-2 bg-white px-3 py-1 rounded-full shadow-sm">Gen c·ªßa b·∫°n ƒëang l·∫Øng nghe h√†nh ƒë·ªông c·ªßa b·∫°n.</p>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Summary Table -->
            <div class="mt-20 mb-10">
                <div class="bg-white rounded-3xl shadow-soft overflow-hidden border border-slate-200">
                    <div class="bg-slate-50 p-6 border-b border-slate-200 text-center">
                        <h2 class="text-xl font-bold text-slate-800 font-tech tracking-wide">T·ªîNG K·∫æT D·ªÆ LI·ªÜU BIO-KARMA</h2>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                            <thead>
                                <tr class="bg-white text-slate-400 text-xs uppercase tracking-wider border-b border-slate-100">
                                    <th class="p-5 font-semibold">C·∫•p ƒê·ªô</th>
                                    <th class="p-5 font-semibold">H√†nh Vi (Nh√¢n)</th>
                                    <th class="p-5 font-semibold">Ph·∫£n ·ª®ng Sinh H·ªçc T·ª©c Th·ªùi (Qu·∫£ Tr√™n Th√¢n)</th>
                                </tr>
                            </thead>
                            <tbody class="text-slate-600 text-sm">
                                <tr class="border-b border-slate-100 hover:bg-slate-50 transition">
                                    <td class="p-5 font-bold text-slate-800">TH√ÇN</td>
                                    <td class="p-5"><span class="text-red-500 font-medium bg-red-50 px-2 py-1 rounded">S√°t sanh</span> vs <span class="text-green-600 font-medium bg-green-50 px-2 py-1 rounded">B·∫£o v·ªá</span></td>
                                    <td class="p-5">Vi√™m m√£n t√≠nh (Cortisol) vs TƒÉng t·∫ø b√†o mi·ªÖn d·ªãch NK</td>
                                </tr>
                                <tr class="border-b border-slate-100 hover:bg-slate-50 transition">
                                    <td class="p-5 font-bold text-slate-800">KH·∫®U</td>
                                    <td class="p-5"><span class="text-red-500 font-medium bg-red-50 px-2 py-1 rounded">N√≥i d·ªëi</span> vs <span class="text-green-600 font-medium bg-green-50 px-2 py-1 rounded">Ch√¢n th·∫≠t</span></td>
                                    <td class="p-5">R·ªëi lo·∫°n nh·ªãp tim (Low HRV) vs Th∆∞ gi√£n s√¢u (Vagus Nerve)</td>
                                </tr>
                                <tr class="hover:bg-slate-50 transition">
                                    <td class="p-5 font-bold text-slate-800">√ù</td>
                                    <td class="p-5"><span class="text-red-500 font-medium bg-red-50 px-2 py-1 rounded">Tham/S√¢n</span> vs <span class="text-green-600 font-medium bg-green-50 px-2 py-1 rounded">T·ª´ Bi</span></td>
                                    <td class="p-5">Teo h·ªìi h·∫£i m√£ (M·∫•t tr√≠ nh·ªõ) vs Ph√°t tri·ªÉn th√πy tr√°n (Tr√≠ tu·ªá)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="border-t border-slate-200 bg-white py-10 text-center">
        <p class="text-slate-500 text-xs font-bold tracking-wide mb-2">PH√ÇN T√çCH D·ª∞A TR√äN NGHI√äN C·ª®U KHOA H·ªåC TH·∫¶N KINH & T√ÅC PH·∫®M "S·ªêNG M∆Ø·ªúI ƒêI·ªÄU L√ÄNH"</p>
        <p class="text-slate-400 text-xs">&copy; 2023 BIO-KARMA PROJECT</p>
    </footer>

    <script>
        // --- DATA & CONFIG ---
        const badState = {
            brainData: [90, 10, 80, 20], // Cortisol, Oxytocin, Adrenaline, Serotonin
            brainText: "H·∫°ch h·∫°nh nh√¢n ph√¨ ƒë·∫°i. V·ªè n√£o tr∆∞·ªõc tr√°n b·ªã ·ª©c ch·∫ø. T∆∞ duy ng·∫Øn h·∫°n, b·ªëc ƒë·ªìng.",
            heartRate: 110,
            heartText: "Nh·ªãp tim nhanh, h·ªón lo·∫°n. Bi·∫øn thi√™n nh·ªãp tim (HRV) th·∫•p. Nguy c∆° ƒë·ªôt qu·ªµ.",
            immuneLevel: 20, 
            immuneText: "H·ªá mi·ªÖn d·ªãch suy y·∫øu. T·∫Øt gen b·∫£o v·ªá. T·∫ø b√†o l√£o h√≥a nhanh.",
            color: '#ef4444', // Red 500
            bg: '#fee2e2' // Red 100
        };

        const goodState = {
            brainData: [15, 90, 20, 85], 
            brainText: "V·ªè n√£o tr∆∞·ªõc tr√°n k√≠ch ho·∫°t. S√°ng su·ªët, b√¨nh tƒ©nh. H·ªìi h·∫£i m√£ ph√°t tri·ªÉn (tr√≠ nh·ªõ t·ªët).",
            heartRate: 65,
            heartText: "Nh·ªãp tim ·ªïn ƒë·ªãnh, s√¢u. Bi·∫øn thi√™n nh·ªãp tim (HRV) cao. Tr·∫°ng th√°i th∆∞ gi√£n s√¢u.",
            immuneLevel: 95, 
            immuneText: "TƒÉng c∆∞·ªùng t·∫ø b√†o NK (di·ªát ung th∆∞). B·∫≠t gen ch·ªëng vi√™m. T√°i t·∫°o t·∫ø b√†o.",
            color: '#10b981', // Emerald 500
            bg: '#d1fae5' // Emerald 100
        };

        // --- CHART SETUP ---
        const ctxBrain = document.getElementById('brainChart').getContext('2d');
        
        // Light mode chart config
        Chart.defaults.color = '#64748b'; // Slate 500 for text
        Chart.defaults.borderColor = '#e2e8f0'; // Slate 200 for grid lines

        const brainChart = new Chart(ctxBrain, {
            type: 'bar',
            data: {
                labels: ['Cortisol (Stress)', 'Oxytocin (Love)', 'Adrenaline (Fear)', 'Serotonin (Peace)'],
                datasets: [{
                    label: 'M·ª©c ƒë·ªô Hormone',
                    data: [50, 50, 50, 50],
                    backgroundColor: [
                        'rgba(239, 68, 68, 0.8)', // Cortisol - Red
                        'rgba(16, 185, 129, 0.8)', // Oxytocin - Green
                        'rgba(245, 158, 11, 0.8)', // Adrenaline - Orange
                        'rgba(59, 130, 246, 0.8)'  // Serotonin - Blue
                    ],
                    borderColor: 'rgba(255,255,255,0.5)',
                    borderWidth: 2,
                    borderRadius: 6
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: { 
                        beginAtZero: true, 
                        max: 100, 
                        grid: { borderDash: [2, 4], color: '#f1f5f9' }, 
                        ticks: { display: false } 
                    },
                    x: { 
                        grid: { display: false }, 
                        ticks: { font: { size: 10, weight: 'bold' } } 
                    }
                },
                plugins: { legend: { display: false } }
            }
        });

        // --- INTERACTION LOGIC ---
        const toggle = document.getElementById('karma-toggle');
        const labelBad = document.getElementById('label-bad');
        const labelGood = document.getElementById('label-good');
        
        // DOM Elements to update
        const brainText = document.getElementById('brain-text');
        const heartIcon = document.getElementById('heart-icon');
        const hrDisplay = document.getElementById('hr-display');
        const heartText = document.getElementById('heart-text');
        const immuneBar = document.getElementById('immune-bar');
        const immuneStatus = document.getElementById('immune-status');
        const bodyText = document.getElementById('body-text');

        function updateDashboard(isGood) {
            const data = isGood ? goodState : badState;

            // 1. Update Switch UI Labels
            if(isGood) {
                labelGood.classList.remove('opacity-50', 'text-slate-400');
                labelGood.classList.add('opacity-100', 'text-green-600');
                labelBad.classList.add('opacity-50', 'text-slate-400');
                labelBad.classList.remove('opacity-100', 'text-red-500');
            } else {
                labelBad.classList.remove('opacity-50', 'text-slate-400');
                labelBad.classList.add('opacity-100', 'text-red-500');
                labelGood.classList.add('opacity-50', 'text-slate-400');
                labelGood.classList.remove('opacity-100', 'text-green-600');
            }

            // 2. Update Brain Chart
            brainChart.data.datasets[0].data = data.brainData;
            brainChart.update();
            brainText.innerHTML = `<span style="color:${data.color}; font-weight:bold;">‚óè</span> ${data.brainText}`;

            // 3. Update Heart Panel
            heartIcon.style.color = data.color;
            // Removed drop-shadow for cleaner light mode look, or use subtle one
            // heartIcon.style.filter = `drop-shadow(0 0 5px ${data.color}40)`; 
            
            if(isGood) {
                heartIcon.classList.remove('heartbeat-stress');
                heartIcon.classList.add('heartbeat');
            } else {
                heartIcon.classList.remove('heartbeat');
                heartIcon.classList.add('heartbeat-stress');
            }
            hrDisplay.innerText = `${data.heartRate} BPM`;
            hrDisplay.style.color = data.color;
            heartText.innerHTML = `<span style="color:${data.color}; font-weight:bold;">‚óè</span> ${data.heartText}`;

            // 4. Update Immune/Body Panel
            immuneBar.style.width = `${data.immuneLevel}%`;
            immuneBar.style.backgroundColor = data.color;
            immuneStatus.innerText = isGood ? "M·∫°nh M·∫Ω (High)" : "Suy Y·∫øu (Low)";
            immuneStatus.style.color = data.color;
            bodyText.innerHTML = `<span style="color:${data.color}; font-weight:bold;">‚óè</span> ${data.immuneText}`;
            
            // 5. Update Voice Waves Visuals
            const voiceContainer = document.getElementById('voice-waves');
            voiceContainer.innerHTML = '';
            const barCount = 30;
            const baseColorClass = isGood ? 'bg-green-400' : 'bg-red-400';
            
            for(let i=0; i<barCount; i++) {
                const bar = document.createElement('div');
                bar.className = `w-1.5 rounded-full ${baseColorClass} opacity-80 transition-all duration-500`;
                
                let h;
                if(isGood) {
                    // Smooth harmonic wave
                    h = 30 + Math.sin(i * 0.4) * 20 + 'px'; 
                } else {
                    // Spiky jagged wave
                    h = 10 + Math.random() * 80 + 'px'; 
                }
                bar.style.height = h;
                voiceContainer.appendChild(bar);
            }
        }

        // Initialize
        toggle.addEventListener('change', (e) => {
            updateDashboard(e.target.checked);
        });

        // Set default to "Bad" (unchecked) on load
        updateDashboard(false); 

    </script>
</body>
</html>
